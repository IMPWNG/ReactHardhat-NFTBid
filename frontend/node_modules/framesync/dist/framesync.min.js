!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).framesync={})}(this,function(e){"use strict";var n=1/60*1e3,t="undefined"!=typeof performance?function(){return performance.now()}:function(){return Date.now()},r="undefined"!=typeof window?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout(function(){return e(t())},n)};function u(e){return a[e].process(c)}var o=!0,s=!1,i=!1,c={delta:0,timestamp:0},f=["read","update","preRender","render","postRender"],a=f.reduce(function(e,n){var u,o,i,c,f,a,d;return e[n]=(u=function(){return s=!0},o=[],c=0,f=!(i=[]),a=new WeakSet,d={schedule:function(e,n,t){void 0===n&&(n=!1),void 0===t&&(t=!1);var r=t&&f,t=r?o:i;return n&&a.add(e),-1===t.indexOf(e)&&(t.push(e),r&&f&&(c=o.length)),e},cancel:function(e){var n=i.indexOf(e);-1!==n&&i.splice(n,1),a.delete(e)},process:function(e){var n;if(f=!0,o=(n=[i,o])[0],(i=n[1]).length=0,c=o.length)for(var t=0;t<c;t++){var r=o[t];r(e),a.has(r)&&(d.schedule(r),u())}f=!1}}),e},{}),d=f.reduce(function(e,n){var r=a[n];return e[n]=function(e,n,t){return void 0===n&&(n=!1),void 0===t&&(t=!1),s||m(),r.schedule(e,n,t)},e},{}),p=f.reduce(function(e,n){return e[n]=a[n].cancel,e},{}),l=function(e){s=!1,c.delta=o?n:Math.max(Math.min(e-c.timestamp,40),1),c.timestamp=e,i=!0,f.forEach(u),i=!1,s&&(o=!1,r(l))},m=function(){o=s=!0,i||r(l)};e.cancelSync=p,e.default=d,e.getFrameData=function(){return c},Object.defineProperty(e,"__esModule",{value:!0})});
